## LOAD LIBRARIES ###
suppressMessages({library(tidyverse, quietly=TRUE)})
suppressMessages({library(stringr, quietly=TRUE)})
suppressMessages({library(dplyr, quietly=TRUE)})
suppressMessages({library(rlang, quietly=TRUE)})
suppressMessages({library(ConQuR, quietly=TRUE)})
suppressMessages({library(doParallel, quietly=TRUE)})
suppressMessages({library(sva, quietly=TRUE)})
suppressMessages({library(MMUPHin, quietly=TRUE)})
suppressMessages({library(PLSDAbatch, quietly=TRUE)})
data <- read.csv('tmp/data.csv', row.names=1)
md <- read.csv('tmp/metadata.csv')
dim(data)
set.seet(42)
library(compositions)
### PLSDAbatch of the CLR adata
clr_pls_out <- PLSDA_batch( clr( 1e-6 + ( data / rowSums(data) ) ),
Y.bat=md$Study %>% as.factor,
near.zero.var=F
)
dim(clr_pls_out$X.nobatch)
clr_pls_out$X.nobatch
